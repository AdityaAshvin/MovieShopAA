@model IEnumerable<ApplicationCore.Models.MovieCardModel>

<div class="row align-items-center mb-4">
    <div class="col-md-6 text-center">
        <img class="img-fluid rounded-2 shadow w-50" src="@ViewBag.ProfilePath" alt="@ViewBag.ActorName" />
    </div>
    <div class="col-md-6">
        <h1 class="fw-bold">
            @ViewBag.ActorName
        </h1>
        <p class="text-muted">
            <a href="@ViewBag.TmdbURL" target="_blank" class="text-dark ms-2" style="text-decoration: none">
                Actor Profile <i class="bi bi-box-arrow-up-right" style="font-size: 1rem;"></i>
            </a>
        </p>
    </div>
</div>


<h2 class="text-center"> Latest Movies </h2>

<div class="rounded">
    <div class="container-fluid">
        <div class="row">
            @foreach (var movie in Model)
            {
                <partial name="_MovieCard" model="movie" />
            }
        </div>
    </div>
</div>

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-start">

        <!-- Previous -->
        <li class="page-item @(ViewBag.CurrentPage == 1 ? "disabled" : "")">
            <a class="page-link"
               asp-action="Index"
               asp-route-id="@ViewBag.ActorId"
               asp-route-page="@(ViewBag.CurrentPage - 1)"
               aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        @* Calculate window *@
        @{
            int totalPages = ViewBag.TotalPages;
            int current = ViewBag.CurrentPage;
            int window = 5; // max numbers to display
            int start = Math.Max(1, current - window / 2);
            int end = Math.Min(totalPages, start + window - 1);

            // adjust start if we don't have enough pages at the end
            if (end - start < window - 1)
            {
                start = Math.Max(1, end - window + 1);
            }
        }

        @for (int i = start; i <= end; i++)
        {
            <li class="page-item @(i == current ? "active" : "")">
                <a class="page-link"
                   asp-action="Index"
                   asp-route-id="@ViewBag.ActorId"
                   asp-route-page="@i">@i</a>
            </li>
        }

        <!-- Next -->
        <li class="page-item @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "")">
            <a class="page-link"
               asp-action="Index"
               asp-route-id="@ViewBag.ActorId"
               asp-route-page="@(ViewBag.CurrentPage + 1)"
               aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>

    </ul>
</nav>